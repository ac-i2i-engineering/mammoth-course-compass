<!DOCTYPE html>
<html class="no-js" lang="python" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Email Scraper &mdash; Access Amherst 0.0.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=02fa4ee0" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="Access Amherst 0.0.0 documentation" href="#" />
            <link rel="next" title="Database Parser" href="parse_database.html" />
            <link rel="prev" title="RSS Scraper" href="rss_scraper.html" />
    </head>
<body>
    <script type="text/javascript" src="_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="event_model.html">Event Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="rss_scraper.html">RSS Scraper</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Email Scraper</a></li>
<li class="toctree-l1"><a class="reference internal" href="parse_database.html">Database Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="generate_map.html">Map Generation</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Email Scraper</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ac-i2i-engineering/access-amherst/" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">GitHub</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="module-access_amherst_algo.email_scraper.email_parser">
<span id="email-scraper"></span><h1>Email Scraper<a class="headerlink" href="#module-access_amherst_algo.email_scraper.email_parser" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="access_amherst_algo.email_scraper.email_parser.connect_and_fetch_latest_email">
<span class="sig-prename descclassname"><span class="pre">access_amherst_algo.email_scraper.email_parser.</span></span><span class="sig-name descname"><span class="pre">connect_and_fetch_latest_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_password</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subject_filter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mail_server</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'imap.gmail.com'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#access_amherst_algo.email_scraper.email_parser.connect_and_fetch_latest_email" title="Link to this definition">¶</a></dt>
<dd><p>Connect to the email server and fetch the latest email matching a subject filter.</p>
<p>This function connects to the specified IMAP email server (default is Gmail),
logs in using the provided app password, and searches for the most recent email
with a subject matching the <cite>subject_filter</cite>. It returns the email message object
of the latest matching email.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app_password</strong> (<em>str</em>) -- The app password used for logging into the email account.</p></li>
<li><p><strong>subject_filter</strong> (<em>str</em>) -- The subject filter used to search for specific emails.</p></li>
<li><p><strong>mail_server</strong> (<em>str</em><em>, </em><em>optional</em>) -- The IMAP email server address (default is 'imap.gmail.com').</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The latest email message matching the filter, or None if no matching email is
found or login fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>email.message.Message or None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">email</span> <span class="o">=</span> <span class="n">connect_and_fetch_latest_email</span><span class="p">(</span><span class="s2">&quot;amherst_college_password&quot;</span><span class="p">,</span> <span class="s2">&quot;Amherst College Daily Mammoth for Sunday, November 3, 2024&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">email</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">email</span><span class="p">[</span><span class="s2">&quot;From&quot;</span><span class="p">])</span>
<span class="go">&#39;noreply@amherst.edu&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="access_amherst_algo.email_scraper.email_parser.extract_email_body">
<span class="sig-prename descclassname"><span class="pre">access_amherst_algo.email_scraper.email_parser.</span></span><span class="sig-name descname"><span class="pre">extract_email_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#access_amherst_algo.email_scraper.email_parser.extract_email_body" title="Link to this definition">¶</a></dt>
<dd><p>Extract the body of an email message.</p>
<p>This function extracts and returns the plain-text body of the given email message.
It handles both multipart and non-multipart emails, retrieving the text content from
the message if available. If the email is multipart, it iterates over the parts to find
the &quot;text/plain&quot; part and decodes it. If the email is not multipart, it directly decodes
the payload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> (<em>email.message.Message</em>) -- The email message object from which to extract the body.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The decoded plain-text body of the email, or None if no text content is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">email_body</span> <span class="o">=</span> <span class="n">extract_email_body</span><span class="p">(</span><span class="n">email_msg</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">email_body</span><span class="p">)</span>
<span class="go">&#39;This is information about Amherst College events on Sunday, November 3, 2024.&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="access_amherst_algo.email_scraper.email_parser.extract_event_info_using_llama">
<span class="sig-prename descclassname"><span class="pre">access_amherst_algo.email_scraper.email_parser.</span></span><span class="sig-name descname"><span class="pre">extract_event_info_using_llama</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">email_content</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#access_amherst_algo.email_scraper.email_parser.extract_event_info_using_llama" title="Link to this definition">¶</a></dt>
<dd><p>Extract event info from the email content using the LLaMA API.</p>
<p>This function sends the provided email content to the LLaMA API for processing.
It sends the email content along with an instruction to extract event details.
If the API response is valid, the function parses and returns the extracted
event information as a list of event JSON objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>email_content</strong> (<em>str</em>) -- The raw content of the email to be processed by the LLaMA API.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of event data extracted from the email content in JSON format.
If extraction fails, an empty list is returned.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="n">extract_event_info_using_llama</span><span class="p">(</span><span class="s2">&quot;We&#39;re hosting a Literature Speaker Event this Tuesday, November 5, 2024 in Keefe Campus Center!&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
<span class="go">[{&quot;title&quot;: &quot;Literature Speaker Event&quot;, &quot;date&quot;: &quot;2024-11-05&quot;, &quot;location&quot;: &quot;Keefe Campus Center&quot;}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="access_amherst_algo.email_scraper.email_parser.parse_email">
<span class="sig-prename descclassname"><span class="pre">access_amherst_algo.email_scraper.email_parser.</span></span><span class="sig-name descname"><span class="pre">parse_email</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject_filter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#access_amherst_algo.email_scraper.email_parser.parse_email" title="Link to this definition">¶</a></dt>
<dd><p>Parse the email and extract event data.</p>
<p>This function connects to an email account, fetches the latest email based on the
provided subject filter, extracts event information from the email body using the
LLaMA API, and saves the extracted events to a JSON file. The file is saved with
a timestamped filename in the 'json_outputs' directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>subject_filter</strong> (<em>str</em>) -- The subject filter to identify the relevant email to fetch.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function does not return any value. It prints status messages
for each stage of the process (success or failure).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_email</span><span class="p">(</span><span class="s2">&quot;Amherst College Daily Mammoth for Sunday, November 3, 2024&quot;</span><span class="p">)</span>
<span class="go">Email fetched successfully.</span>
<span class="go">Events saved successfully to extracted_events_20231107_150000.json.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="access_amherst_algo.email_scraper.email_parser.save_to_json_file">
<span class="sig-prename descclassname"><span class="pre">access_amherst_algo.email_scraper.email_parser.</span></span><span class="sig-name descname"><span class="pre">save_to_json_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#access_amherst_algo.email_scraper.email_parser.save_to_json_file" title="Link to this definition">¶</a></dt>
<dd><p>Save the extracted events to a JSON file.</p>
<p>This function checks if the specified folder exists, creates it if it does not,
and saves the provided event data to a JSON file with the specified filename.
The data is saved with indentation for readability and structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em><em> or </em><em>list</em>) -- The data to be saved in JSON format. Typically, this would be a list or dictionary
containing event data.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) -- The name of the file where the data will be saved
(e.g., 'extracted_events_20241103_124530.json').</p></li>
<li><p><strong>folder</strong> (<em>str</em>) -- The folder where the JSON file will be stored
(e.g., 'json_outputs').</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Literature Speaker Event&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-11-05&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;Keefe Campus Center&quot;</span><span class="p">}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_to_json_file</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="s2">&quot;extracted_events_20241103_124530.json&quot;</span><span class="p">,</span> <span class="s2">&quot;json_outputs&quot;</span><span class="p">)</span>
<span class="go">Data successfully saved to json_outputs/extracted_events_20241103_124530.json</span>
</pre></div>
</div>
</dd></dl>

</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="rss_scraper.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>RSS Scraper
    </a>
    <a class="float-right" href="parse_database.html" title="Next">
        Database Parser <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Email Scraper</a><ul>
<li><a class="reference internal" href="#access_amherst_algo.email_scraper.email_parser.connect_and_fetch_latest_email"><code class="docutils literal notranslate"><span class="pre">connect_and_fetch_latest_email()</span></code></a></li>
<li><a class="reference internal" href="#access_amherst_algo.email_scraper.email_parser.extract_email_body"><code class="docutils literal notranslate"><span class="pre">extract_email_body()</span></code></a></li>
<li><a class="reference internal" href="#access_amherst_algo.email_scraper.email_parser.extract_event_info_using_llama"><code class="docutils literal notranslate"><span class="pre">extract_event_info_using_llama()</span></code></a></li>
<li><a class="reference internal" href="#access_amherst_algo.email_scraper.email_parser.parse_email"><code class="docutils literal notranslate"><span class="pre">parse_email()</span></code></a></li>
<li><a class="reference internal" href="#access_amherst_algo.email_scraper.email_parser.save_to_json_file"><code class="docutils literal notranslate"><span class="pre">save_to_json_file()</span></code></a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/features/">Features</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/about-wagtail/"> About Wagtail</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/services/"> Services</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/blog/"> Blog</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/packages/"> Packages</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/developers/"> Developers</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2024, Dhyey Mavani, Liam Davis, Ryan Ji, Shreya Hegde, Thu Hoang
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.4.0
                    </a>
                    and
                    <a href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 8.1.3
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="_static/documentation_options.js?v=3dc53093"></script>
        <script src="_static/doctools.js?v=9bcbadda"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script type="text/javascript" src="_static/dist/theme.js"></script>
        <script type="text/javascript" src="_static/dist/vendor.js"></script>
        <script type="text/javascript" src="_static/searchtools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>